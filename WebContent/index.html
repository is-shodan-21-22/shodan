<!DOCTYPE html>
<html>
	<head>
		<meta charset="ISO-8859-1">
		<title>Shodan</title>
		<link rel="stylesheet" href="style/main.css">
		<script
		 	src="https://code.jquery.com/jquery-3.6.0.min.js"
		 	integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
		 	crossorigin="anonymous">
		</script>
		<script>
			console.log("UID: " + localStorage.getItem("uid"));
		
			if(localStorage.hasOwnProperty("uid"))
				window.location.replace('dashboard.html');
		</script>
	</head>
	
	<body>
		<div id="landing-page">
			<header>
				<div id="register" class="button register button--submit">
					Registrati
				</div>
				
				<div id="login" class="button login button--submit">
					Accedi
				</div>
			
				<div class="logo">
					<h1>
						Shodan
					</h1>
					
					<h2>
						Relive The Good Old 90's
					</h2>
				</div>	
			</header>
			
			<div class="content">
				<div class="featured-games">
					<div class="game-container">
						<div class="game-image first-game-image"></div>
						
						<div class="game-motto first-game-motto">
							Ispirati dalle recenti pubblicazioni di rivisitamenti 
							a vecchi titoli, <span class="sd">Shodan</span> 
							permette agli appassionati 
							e ai fan più sfegatati di recuperare titoli 
							e videogiochi di oltre 20 anni fa!
						</div>
					</div>
					<div class="game-container">
						<div class="game-motto second-game-motto">
							Capolavori come 
							<span class="hf">Half Life</span>, 
							<span class="ff">Final Fantasy</span>, 
							<span class="ss">System Shock</span>, 
							<span class="dm">Doom</span>, 
							<span class="cc">Command & Conquer</span>, 
							e molti altri, 
							ti aspettano nella nostra libreria!
						</div>
						
						<div class="game-image second-game-image"></div>
					</div>
					<div class="game-container">
						<div class="game-image third-game-image"></div>
						
						<div class="game-motto third-game-motto">
							Rivisita i capolavori che hanno definito 
							l'industria videoloudica moderna, 
							recupera vecchi classici e rivivi emozioni dimenticate!
						</div>
					</div>
				</div>
			</div>
		</div>
	
		<div id="login-form">
			<form onsubmit="login(); return false">
				<h1>
					Accesso
				</h1>
			
 				<input id="login-username" required placeholder="Username" type="text" name="login_username"><br />
 				<input id="login-password" required placeholder="Password" type="password" name="login_password"><br />
 				<input id="login-submit" type="submit" name="login_submit">
			</form>
		</div>
		
	</body>
		
	<script>
		
		function login() {
			$.ajax(
				{	
					method: "POST",
					data: 
						{ 
							username: $("#login-username").val(), 
							password: $("#login-password").val()
						},
					url: "loginServlet"
				}
			).done(
				(data) => {
					console.log(data);
					if(!data.includes("unknown")){
						console.log("Accesso...");
						localStorage.setItem("uid", data);
						location.reload();
					} else
						alert("L'utente non esiste");
				}
			);
		}
	
		let login_form = false;
	
		$('#landing-page').click(
			() => {
				if(login_form) {
					$('#landing-page').css('opacity', '1');
					
					$('#login-form').css('top', '-155px');
					
					$('#login-form').css('display', 'none');
					
					login_form = false;
				}
			}
		);
	
		$('#login').click(
			() => {
				$('#landing-page').css('opacity', '0.1');
				
				$('#login-form').css('display', 'flex');
				
				setTimeout(() => 
					$('#login-form').css('top', '250px'),
				0);
				
				setTimeout(() => 
					login_form = true,		
				2);
			}
		);
		
	</script>
</html>